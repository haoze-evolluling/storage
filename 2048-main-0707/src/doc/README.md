# 2048游戏代码结构说明

## 代码拆分概述

原来的 `main.js` 文件已经被拆分成三个模块化的文件：

### 1. `game-core.js` - 游戏核心逻辑
**职责：** 负责2048游戏的核心逻辑和数据管理

**主要功能：**
- 游戏状态管理（网格、分数、游戏结束状态）
- 方块移动逻辑（上下左右四个方向）
- 方块合并算法
- 新方块生成
- 游戏结束检测
- 最高分保存和加载

**主要类：**
- `Game2048` - 游戏核心类

**主要方法：**
- `initializeGame()` - 初始化游戏
- `moveUp/Down/Left/Right()` - 四个方向的移动
- `generateNewTile()` - 生成新方块
- `canMove()` - 检查是否还能移动
- `gameOver()` - 游戏结束处理

### 2. `ui-manager.js` - UI管理和背景控制
**职责：** 负责用户界面、动画效果和背景管理

**主要功能：**
- DOM元素管理
- 游戏界面更新
- 动画效果（新方块、合并、震动等）
- 背景选择和切换
- 模态框管理
- 触摸事件处理
- 按钮效果

**主要类：**
- `UIManager` - UI管理类

**主要方法：**
- `initializeUI()` - 初始化游戏界面
- `initializeBackgroundSelector()` - 初始化背景选择器
- `updateUI()` - 更新游戏界面
- `updateScore()` - 更新分数显示
- `showNewTileAnimation()` - 显示新方块动画
- `showMergeAnimation()` - 显示合并动画
- `setupTouchEvents()` - 设置触摸事件

### 3. `main.js` - 主控制器
**职责：** 协调游戏核心逻辑和UI管理，处理用户输入

**主要功能：**
- 模块导入和实例化
- 事件监听器设置
- 键盘和触摸事件处理
- 游戏逻辑和UI的协调
- 游戏初始化

**主要函数：**
- `initializeGame()` - 游戏初始化
- `handleKeyPress()` - 键盘事件处理
- `handleSwipe()` - 滑动事件处理
- `handleMoveResult()` - 移动结果处理
- `setupEventListeners()` - 事件监听器设置

## 模块化的优势

### 1. **关注点分离**
- 游戏逻辑与UI完全分离
- 每个模块有明确的职责
- 代码更易理解和维护

### 2. **可重用性**
- `Game2048`类可以在其他项目中重用
- `UIManager`可以适配不同的游戏界面
- 模块可以独立测试

### 3. **可扩展性**
- 可以轻松添加新的UI效果
- 可以扩展游戏规则
- 可以添加新的背景或主题

### 4. **维护性**
- 修改游戏逻辑不会影响UI
- 修改UI不会影响游戏逻辑
- 代码结构清晰，便于调试

## 文件依赖关系

```
main.js
├── game-core.js (Game2048)
└── ui-manager.js (UIManager)
```

## 使用方法

1. 确保HTML文件中使用 `<script type="module" src="main.js"></script>`
2. 所有文件必须通过HTTP服务器访问（不能直接打开HTML文件）
3. 浏览器需要支持ES6模块

## 技术特性

- **ES6模块系统** - 使用import/export
- **类的封装** - 面向对象设计
- **事件驱动** - 响应式用户交互
- **本地存储** - 保存游戏数据
- **响应式设计** - 支持触摸和键盘操作
